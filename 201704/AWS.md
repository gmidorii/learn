# AWS

## IAM (Identity and Access Management)
- 使用料無料
- IAMユーザー : 認証
  - AWSアカウントに紐づくユーザー
  - 個別のアクセスキーを作成できる
  - AWSのアクセスキーを取得するために作成したりもする
  - デフォルトでは何にもアクセスできない
  - IAMグループにまとめてポリシーをアタッチする
- IAMポリシー : 承認
  - 許可されているアクションは何かの定義
  - ユーザーベースポリシー
    - ユーザーがアクセスできるリソースを定義
  - リソースベースポリシー
    - 許可されるアクションと、影響を受けるリソースを指定
    - リソースへアクセスできるユーザーも合わせて定義
    - Principalエレメントを利用
  - ポリシー(JSON)は最適化変換をされる可能性があるため文字列比較をしない
  - Actions, Resources, Effect
- IAMロール : 委任
  - アクションおよびリソースへのアクセスを許可する一連のアクセス権限
  - 利用可能者
    - ロールと同じAWSアカウントのIAMユーザー
    - ロールと異なるAWSアカウントのIAMユーザー →　これにより異なるアカウントからアクセスできるようにする
  - 委任するために
    - IAMロールに2つのポリシーをアタッチ
      - アクセス権限ポリシー(どのリソースにアクセス許可をさせるか) and 信頼ポリシー(どのアカウントに委任させるか)
    - 別アカウントのIAMユーザーにロールを引き受けられるアクセス制限ポリシーをアタッチ
  - ロールを受けると一時的にもとのアクセス権限は失う
- Principal
  - アクションを実行してリソースにアクセスできるエンティティ
  - root, IAMユーザー, IAMロールを設定できる
- アクセスキー
  - AWS CLIを使用するために利用する
  - コンソールで作成
  - `aws configure` を実行して、AccessKeyとSecretAccessKeyをセット
  - IAMユーザーのポリシーに則りアクセスできる
